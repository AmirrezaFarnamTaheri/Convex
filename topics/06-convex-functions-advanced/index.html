<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>06. Convex Functions: Advanced Topics — Convex Optimization</title>
  <link rel="stylesheet" href="../../static/css/lecture-styles.css" />
  <link rel="stylesheet" href="../../static/css/convex-unified.css" />
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" />
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
  <header class="site-header sticky">
    <div class="container">
      <div class="brand">
        <a href="../../index.html">Convex Optimization</a>
      </div>
      <nav class="nav">
        <a href="../../index.html"><i data-feather="grid"></i> All Lectures</a>
        <a href="../05-convex-functions-basics/index.html"><i data-feather="arrow-left"></i> Previous</a>
        <a href="../07-convex-problems-standard/index.html">Next <i data-feather="arrow-right"></i></a>
      </nav>
    </div>
  </header>

    <article>
      <section class="section-card" id="section-1">
      <h2>1. The Convex Conjugate (Fenchel Conjugate)</h2>

      <div class="insight">
        <h4>Core Idea</h4>
        <p>Given a function $f$, the conjugate $f^*$ is <b>"the best linear lower bound"</b> to $f$, encoded as a function of the slope $y$. This transformation is the bridge to duality.</p>
      </div>

      <h3>1.1 Definition and Geometry</h3>
      <p>Let $f : \mathbb{R}^n \to \mathbb{R} \cup \{+\infty\}$ be an extended-real function. Its <a href="#" class="definition-link" data-term="convex conjugate">Fenchel conjugate</a> is defined as:</p>
      $$
      \boxed{f^*(y) = \sup_{x \in \mathrm{dom}\, f} \left( y^\top x - f(x) \right)}
      $$
      <p>The domain of the conjugate is $\mathrm{dom}\, f^* = \{ y \in \mathbb{R}^n \mid \sup_x (y^\top x - f(x)) < +\infty \}$.</p>

      <h4>Geometric Interpretation</h4>
      <p>Consider the affine function $h(x) = y^\top x - c$. For this to be a lower bound on $f$ (i.e., $h(x) \le f(x)$ everywhere), we need $c \ge y^\top x - f(x)$. The tightest (smallest) such $c$ is $f^*(y)$. Thus, $y^\top x - f^*(y)$ is the best affine underestimator of $f$ with slope $y$.</p>

      <h3>1.2 Basic Properties</h3>
      <ul>
        <li><b>Convexity:</b> $f^*$ is always convex, because it is the pointwise supremum of a family of affine functions of $y$.</li>
        <li><b>Fenchel's Inequality:</b> Directly from the definition:
        $$ \boxed{f(x) + f^*(y) \ge x^\top y} $$
        Equality holds if and only if $y \in \partial f(x)$ (convex case). This generalizes the inequality $xy \le \frac{1}{2}x^2 + \frac{1}{2}y^2$.</li>
      </ul>

      <h3>1.3 Differentiable Case: Legendre Transform</h3>
      <p>If $f$ is strictly convex and differentiable, the maximum in the definition occurs where $\nabla_x (y^\top x - f(x)) = 0$, i.e., $y = \nabla f(x)$. Let $x^* = (\nabla f)^{-1}(y)$. Then:
      $$ f^*(y) = y^\top x^* - f(x^*) $$
      This specific case is the classical Legendre transform.</p>

      <h3>1.4 1D Examples: Detailed Derivations</h3>

      <div class="example">
        <h4>1. Affine Function: $f(x) = ax + b$</h4>
        <p>$$ f^*(y) = \sup_{x} (yx - ax - b) = \sup_x ((y-a)x - b) $$</p>
        <p>If $y \ne a$, the term is linear in $x$ with a non-zero slope. As $x \to \infty$ or $x \to -\infty$, the value goes to $\infty$. Thus the supremum is unbounded. If $y=a$, the expression simplifies to $-b$.
        $$ f^*(y) = \begin{cases} -b & y=a \\ \infty & y \ne a \end{cases} $$</p>
      </div>

      <div class="example">
        <h4>2. Negative Log: $f(x) = -\log x$ on $\mathbb{R}_{++}$</h4>
        <p>Maximize $yx + \log x$. Derivative $y + 1/x = 0 \implies x = -1/y$.
        <br>Requires $y < 0$ for $x > 0$.
        <br>Value: $y(-1/y) + \log(-1/y) = -1 - \log(-y)$.
        $$ f^*(y) = \begin{cases} -1 - \log(-y) & y < 0 \\ \infty & \text{otherwise} \end{cases} $$</p>
      </div>

      <div class="example">
        <h4>3. Exponential: $f(x) = e^x$</h4>
        <p>Maximize $yx - e^x$. Derivative $y - e^x = 0 \implies x = \log y$. Requires $y > 0$.
        <br>Value: $y \log y - e^{\log y} = y \log y - y$.
        <br>Boundary $y=0$: $\sup (-e^x) = 0$. For $y<0$, unbounded.
        $$ f^*(y) = \begin{cases} y \log y - y & y \ge 0 \\ \infty & y < 0 \end{cases} $$</p>
      </div>

      <h3>1.5 Matrix and Vector Examples</h3>

      <div class="example">
        <h4>1. Quadratic: $f(x) = \frac{1}{2} x^\top Q x$ ($Q \succ 0$)</h4>
        <p>Maximize $y^\top x - \frac{1}{2} x^\top Q x$.
        <br>Gradient zero: $y - Qx = 0 \implies x = Q^{-1}y$.
        <br>Value: $y^\top Q^{-1}y - \frac{1}{2} (Q^{-1}y)^\top Q (Q^{-1}y) = \frac{1}{2} y^\top Q^{-1} y$.
        <br><b>Result:</b> The conjugate of a quadratic is a quadratic with the inverse matrix.</p>
      </div>

      <div class="example">
        <h4>2. Norm Squared: $f(x) = \frac{1}{2}\|x\|^2$</h4>
        <p>Using dual norm definition ($y^\top x \le \|x\|\|y\|_*$) and Young's inequality:
        $$ f^*(y) = \sup_x (y^\top x - \frac{1}{2}\|x\|^2) = \frac{1}{2}\|y\|_*^2 $$
        where $\|\cdot\|_*$ is the dual norm.</p>
      </div>

      <div class="example">
        <h4>3. Log-Sum-Exp and Entropy</h4>
        <p>Let $f(x) = \log(\sum e^{x_i})$. This is a key function in ML.
        <br>Maximize $y^\top x - f(x)$. Gradient condition: $y_i = e^{x_i} / (\sum e^{x_k})$.
        <br>This implies $y > 0$ and $\mathbf{1}^\top y = 1$ (probability simplex $\Delta$).
        <br>Inverting: $e^{x_i} = y_i (\sum e^{x_k})$. Taking log: $x_i = \log y_i + C$.
        <br>Substitute back:
        $$ y^\top x - f(x) = \sum y_i (\log y_i + C) - \log(\sum y_i e^C) $$
        $$ = \sum y_i \log y_i + C \sum y_i - (C + \log 1) = \sum y_i \log y_i $$
        <b>Result:</b> The conjugate is the <b>negative entropy</b> on the simplex:
        $$ f^*(y) = \begin{cases} \sum y_i \log y_i & y \in \Delta \\ \infty & \text{otherwise} \end{cases} $$
        </p>
      </div>

      <div class="example">
        <h4>4. Log-Determinant</h4>
        <p>For $f(X) = -\log \det X$ on $\mathbb{S}^n_{++}$:
        $$ f^*(Y) = \begin{cases} -n - \log \det(-Y) & Y \prec 0 \\ \infty & \text{otherwise} \end{cases} $$
        The conjugate relates $\mathbb{S}^n_{++}$ to $\mathbb{S}^n_{--}$ (negative definite).</p>
      </div>

      <h3>1.6 The Biconjugate Theorem</h3>
      <p>The <b>biconjugate</b> $f^{**} = (f^*)^*$ is the closed convex hull of $f$.
      <br><b>Theorem:</b> If $f$ is closed and convex, then $f^{**} = f$.
      <br>This equivalence ($f$ vs supremum of affine functions) is the foundation of dual decomposition.</p>
    </section>

    <section class="section-card" id="section-2">
        <h2>2. Quasi-Convex Functions</h2>

        <h3>2.1 Definition via Sublevel Sets</h3>
        <p>A function $f: \mathbb{R}^n \to \mathbb{R}$ is <a href="#" class="definition-link">quasi-convex</a> if its domain is convex and all its <b>sublevel sets</b> are convex:</p>
        $$
        S_\alpha = \{x \in \mathrm{dom}\, f \mid f(x) \le \alpha\}
        $$
        <p>is convex for all $\alpha \in \mathbb{R}$. Geometrically, the function is "unimodal" or "valley-shaped" but may not have positive curvature everywhere.</p>

        <h3>2.2 Modified Jensen's Inequality</h3>
        <p>$f$ is quasi-convex if and only if:</p>
        $$
        f(\theta x + (1-\theta)y) \le \max\{f(x), f(y)\}
        $$
        <p>for all $x, y \in \mathrm{dom}\, f$ and $\theta \in [0, 1]$. The value on a segment never exceeds the larger endpoint.</p>

        <h3>2.3 Differentiable Conditions</h3>
        <ul>
            <li><b>First-Order:</b> $f(y) \le f(x) \implies \nabla f(x)^\top (y - x) \le 0$. (The gradient defines a supporting hyperplane to the sublevel set).</li>
            <li><b>Second-Order:</b> If $v^\top \nabla f(x) = 0$, then $v^\top \nabla^2 f(x) v \ge 0$. (Curvature is non-negative along contours).</li>
        </ul>

        <h3>2.4 Operations Preserving Quasi-Convexity</h3>
        <ul>
            <li><b>Max:</b> $f(x) = \max_i f_i(x)$ is quasi-convex (Intersection of convex sublevel sets is convex).</li>
            <li><b>Composition:</b> $g(h(x))$ is quasi-convex if $h$ is quasi-convex and $g$ is <b>non-decreasing</b>.</li>
            <li><b>Warning:</b> Sums of quasi-convex functions are generally <b>not</b> quasi-convex.</li>
        </ul>

        <h3>2.5 Examples</h3>
        <div class="example">
          <h4>1. Linear-Fractional Function</h4>
          <p>$f(x) = \frac{a^\top x + b}{c^\top x + d}$ on $\{x \mid c^\top x + d > 0\}$.
          <br>Sublevel set: $a^\top x + b \le \alpha (c^\top x + d)$. This is a linear inequality (halfspace), so $f$ is quasi-convex (and quasi-concave).</p>
        </div>

        <div class="example">
          <h4>2. Distance Ratio</h4>
          <p>$f(x) = \frac{\|x-a\|_2}{\|x-b\|_2}$ on $\{x \mid \|x-a\| \le \|x-b\|\}$.
          <br>Condition $f(x) \le \alpha$ squares to a quadratic inequality defining a ball (Apollonius circle). Thus quasi-convex.</p>
        </div>

        <div class="example">
          <h4>3. Internal Rate of Return (IRR)</h4>
          <p>The IRR is a quasi-concave function of the cash flows (superlevel sets are convex).</p>
        </div>
    </section>

    <section class="section-card" id="section-3">
        <h2>3. Log-Concave Functions</h2>

        <h3>3.1 Definition</h3>
        <p>A function $f: \mathbb{R}^n \to \mathbb{R}_{++}$ is <a href="#" class="definition-link">log-concave</a> if $\log f(x)$ is concave.
        $$ f(\theta x + (1-\theta)y) \ge f(x)^\theta f(y)^{1-\theta} $$
        Many probability densities are log-concave.</p>

        <h3>3.2 Properties</h3>
        <ul>
            <li><b>Hessian Condition:</b> $f(x) \nabla^2 f(x) \preceq \nabla f(x) \nabla f(x)^\top$.</li>
            <li><b>Product:</b> Products of log-concave functions are log-concave.</li>
            <li><b>Marginals:</b> If $f(x, y)$ is log-concave, $\int f(x, y) dy$ is log-concave (Prékopa-Leindler).</li>
            <li><b>Convolution:</b> Convolution of log-concave functions is log-concave.</li>
        </ul>

        <h3>3.3 Examples</h3>
        <div class="example">
            <ul>
                <li><b>Gaussian Density:</b> $\exp(-\frac{1}{2}x^\top \Sigma^{-1} x)$ has a concave quadratic log.</li>
                <li><b>Indicator of Convex Set:</b> Log is 0 or $-\infty$ (concave).</li>
                <li><b>Determinant:</b> $\det X$ is log-concave on $\mathbb{S}^n_{++}$.</li>
                <li><b>CDF:</b> If a PDF is log-concave, its CDF is log-concave.</li>
            </ul>
        </div>
    </section>

    <section class="section-card" id="section-4">
      <h2>4. Review & Cheat Sheet</h2>
      <h3>Conjugate Transformations</h3>
      <table class="data-table">
        <tr><th>Primal $f(x)$</th><th>Conjugate $f^*(y)$</th></tr>
        <tr><td>$\frac{1}{2}x^\top Q x$ ($Q \succ 0$)</td><td>$\frac{1}{2}y^\top Q^{-1} y$</td></tr>
        <tr><td>$-\log x$</td><td>$-1 - \log(-y)$</td></tr>
        <tr><td>$\log(\sum e^{x_i})$</td><td>$\sum y_i \log y_i$ (Neg Entropy) on $\Delta$</td></tr>
        <tr><td>$I_C(x)$</td><td>$S_C(y)$ (Support Function)</td></tr>
        <tr><td>$\|x\|$</td><td>$I_{B_*}(y)$ (Indicator of dual unit ball)</td></tr>
      </table>
    </section>

    <section class="section-card" id="section-5">
      <h2><i data-feather="edit-3"></i> 5. Exercises</h2>

      <div class="problem">
        <h3>P6.1 — Conjugate of Norm Squared</h3>
        <p>Compute the conjugate of $f(x) = \frac{1}{2}\|x\|^2$ for a general norm $\|\cdot\|$. Show it is $\frac{1}{2}\|y\|_*^2$.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>We want $\sup_x (y^\top x - \frac{1}{2}\|x\|^2)$.
          <br>By definition of dual norm, $y^\top x \le \|y\|_* \|x\|$.
          <br>Let $u = \|x\|$. The objective is bounded by $\|y\|_* u - \frac{1}{2}u^2$.
          <br>This quadratic in $u$ is maximized at $u^* = \|y\|_*$, value $\frac{1}{2}\|y\|_*^2$.
          <br>This bound is achieved by choosing $x$ aligned with $y$ (dual vector) with magnitude $\|y\|_*$.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.2 — Quasi-Convexity of Ceiling</h3>
        <p>Show that $f(x) = \lceil x \rceil$ is quasi-convex.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>The sublevel set $S_\alpha = \{x \mid \lceil x \rceil \le \alpha\}$ is equivalent to $\{x \mid x \le \lfloor \alpha \rfloor\}$. This is an interval $(-\infty, \lfloor \alpha \rfloor]$, which is a convex set. Thus $f$ is quasi-convex.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.3 — Softmax Analysis</h3>
        <p>For $f(x) = \log(\sum e^{x_i})$:
        <ol type="a"><li>Show $\max x_i \le f(x) \le \max x_i + \log n$.</li><li>Show $f$ is convex via Hessian $\text{diag}(p) - pp^\top$.</li></ol></p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>(a) Let $M = \max x_i$. $\sum e^{x_i} = e^M \sum e^{x_i-M}$. Bounds follow from $1 \le \sum e^{x_i-M} \le n$.
          <br>(b) $\nabla^2 f = \text{diag}(p) - pp^\top$. $v^\top \nabla^2 f v = \sum p_i v_i^2 - (\sum p_i v_i)^2 = \text{Var}(Z) \ge 0$.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.4 — Concavity of Geometric Mean</h3>
        <p>Prove $G(x) = (\prod x_i)^{1/n}$ is concave on $\mathbb{R}^n_{++}$ using log-concavity.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>$\log G(x) = \frac{1}{n} \sum \log x_i$. Since $\log$ is concave, $\log G$ is concave. Thus $G$ is log-concave.
          <br>Also $G$ is homogeneous of degree 1.
          <br>A log-concave, 1-homogeneous function is concave. (Proof: $G(x+y) \ge G(x)+G(y)$ using convexity of arguments).</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.5 — Geometric Mean Cone</h3>
        <p>Show $K = \{x \in \mathbb{R}^n_+ \mid G(x) \ge \alpha A(x)\}$ is a convex cone for $\alpha \in [0,1]$.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>Rewriting: $G(x) - \alpha A(x) \ge 0$. $G$ is concave, $A$ is linear (concave). Sum is concave. Superlevel set of concave function is convex.
          <br>Homogeneity implies it is a cone.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.6 — Matrix Fractional Function</h3>
        <p>Prove convexity of $f(x, Y) = x^\top Y^{-1} x$ via epigraph.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>Epigraph $t \ge x^\top Y^{-1} x$ is equivalent to LMI $\begin{bmatrix} Y & x \\ x^\top & t \end{bmatrix} \succeq 0$. Since PSD cone is convex, epigraph is convex.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.7 — Fenchel's Inequality & Biconjugate</h3>
        <p>For $f(x) = \frac{1}{2}x^\top Q x$, verify $f(x)+f^*(y) \ge x^\top y$ and $f^{**} = f$.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>Inequality reduces to $\|Q^{1/2}x - Q^{-1/2}y\|^2 \ge 0$.
          <br>Biconjugate: Conjugate of $\frac{1}{2}y^\top Q^{-1} y$ uses matrix $(Q^{-1})^{-1} = Q$. Returns $f$.</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.8 — Quasiconvexity of Distance Ratio</h3>
        <p>Show $\{x \mid \|x-a\| \le \theta \|x-b\|\}$ is convex for $\theta \le 1$.</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>Squaring: $\|x-a\|^2 \le \theta^2 \|x-b\|^2$. Expands to $(1-\theta^2)x^\top x + \dots \le 0$. For $\theta \le 1$, quadratic coeff is $\ge 0$, so convex (ball).</p>
        </div>
      </div>

      <div class="problem">
        <h3>P6.9 — Log-Concavity of Probability Measures</h3>
        <p>If $p(x)$ is log-concave, show $f(x) = \mathbb{P}(x+w \in C)$ is log-concave ($C$ convex).</p>
        <div class="solution-box">
          <h4>Solution</h4>
          <p>$f(x) = \int I_C(u) p(u-x) du$. Convolution of log-concave functions ($I_C$ and $p$) is log-concave.</p>
        </div>
      </div>
<div class="problem">
  <h3>P6.10 — Log-Concavity of Gaussian</h3>
  <p>Show that the multivariate Gaussian density function $f(x)$ is log-concave.</p>
  $$ f(x) = \frac{1}{(2\pi)^{n/2} (\det \Sigma)^{1/2}} \exp\left(-\frac{1}{2}(x-\mu)^\top \Sigma^{-1} (x-\mu)\right) $$
  <p>where $\Sigma \succ 0$.</p>

  <div class="solution-box">
    <h4>Solution</h4>
    <div class="proof-step">
      Take the logarithm:
      $$ \log f(x) = -\frac{n}{2}\log(2\pi) - \frac{1}{2}\log(\det \Sigma) - \frac{1}{2}(x-\mu)^\top \Sigma^{-1} (x-\mu) $$
    </div>
    <div class="proof-step">
      The first two terms are constants. The third term is a quadratic form.
      Let $g(x) = \log f(x)$. The gradient is $\nabla g(x) = -\Sigma^{-1}(x-\mu)$.
      The Hessian is $\nabla^2 g(x) = -\Sigma^{-1}$.
    </div>
    <div class="proof-step">
      Since $\Sigma \succ 0$, its inverse $\Sigma^{-1} \succ 0$, so $-\Sigma^{-1} \prec 0$ (negative definite).
      Since the Hessian is negative definite everywhere, $g(x)$ is strictly concave.
      Therefore, $f(x)$ is log-concave.
    </div>
  </div>
</div>


    </section>
    </article>

    <footer class="site-footer">
      <div class="container">
        <p>© <span id="year"></a> Convex Optimization Course</p>
      </div>
    </footer>
  </main></div>

  <script src="../../static/js/math-renderer.js"></script>
  <script src="../../static/js/ui.js"></script>
  <script src="../../static/js/toc.js"></script>
  <script>
    feather.replace();
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

  <!-- Widget Loaders -->
  <script type="module">
    import { initConvexFunctionInspector } from './widgets/js/convex-function-inspector.js';
    initConvexFunctionInspector('widget-convex-function-inspector');
  </script>
  <script type="module">
    import { initHessianHeatmap } from './widgets/js/hessian-heatmap.js';
    initHessianHeatmap('widget-hessian-heatmap');
  </script>
  <script type="module">
    import { initOperationsPreserving } from './widgets/js/operations-preserving.js';
    initOperationsPreserving('widget-operations-preserving');
  </script>
  <script src="../../static/js/glossary-loader.js"></script>
<script src="../../static/js/notes-widget.js"></script>
<script src="../../static/js/pomodoro.js"></script>
<script src="../../static/js/progress-tracker.js"></script>
</body>
</html>
